{
  "gitSyncId": "6872108d46877c6bf2e3ad57_3e107dd0-b772-4bca-9737-308abc37ea8d",
  "id": "All Cases 1_Query2",
  "pluginId": "postgres-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "SELECT \n    -- Count of cases expiring within 1 year\n    COUNT(CASE \n        WHEN (c.lead_date + INTERVAL '1 year' * CAST(c.offense_base AS INTEGER)) <= (CURRENT_DATE + INTERVAL '1 year')\n        THEN 1 \n    END) as critical_cases_1_year,\n    \n    -- Count of cases expiring within 3 years (but more than 1 year)\n    COUNT(CASE \n        WHEN (c.lead_date + INTERVAL '1 year' * CAST(c.offense_base AS INTEGER)) <= (CURRENT_DATE + INTERVAL '3 years')\n        AND (c.lead_date + INTERVAL '1 year' * CAST(c.offense_base AS INTEGER)) > (CURRENT_DATE + INTERVAL '1 year')\n        THEN 1 \n    END) as warning_cases_3_years,\n    \n    -- Total active cases with expiration dates\n    COUNT(*) as total_active_cases\nFROM \n    \"case\" c\nWHERE \n    -- Only cases with lead_date (not null)\n    c.lead_date IS NOT NULL\n    -- Only cases with valid offense_base\n    AND c.offense_base IS NOT NULL \n    AND c.offense_base != ''\n    -- Cases not yet expired\n    AND (c.lead_date + INTERVAL '1 year' * CAST(c.offense_base AS INTEGER)) > CURRENT_DATE\n    -- Division filter\n    AND (\n        '{{ Slc_Division.selectedOptionValue }}' = '' \n        OR '{{ Slc_Division.selectedOptionValue }}' IS NULL\n        OR {{ Slc_Division.selectedOptionValue }} = 0\n        OR CAST(c.responsible_district AS INTEGER) = {{ Slc_Division.selectedOptionValue }}\n    );\n",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "mainDB",
      "isAutoGenerated": false,
      "name": "mainDB",
      "pluginId": "postgres-plugin"
    },
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "name": "Query2",
    "pageId": "All Cases 1",
    "runBehaviour": "MANUAL",
    "userSetOnLoad": false
  }
}